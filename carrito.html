<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carrito</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/styles.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">


<style>
.producto-img {
  width: 100px;
  height: 100px;
  object-fit: cover;
  border-radius: 8px;
}

.cantidad-btn {
  width: 30px;
  height: 30px;
  border: none;
  background: #eee;
  font-weight: bold;
}

.cantidad-btn:hover {
  background: #ddd;
}
</style>

</head>

<div id="navbar-container"></div>

<body >

<section class="container my-5">
<div id="lista-carrito"></div>

<div class="mt-4 text-end">
  <h4>Total: $<span id="total">0</span></h4>
</div>

<div class="mt-3 d-flex justify-content-end gap-2">
  <button onclick="vaciarCarrito()" class="btn btn-outline-danger">
    Vaciar carrito
  </button>
  
  <a href="checkout.html" class="btn btn-dark">
    Finalizar Compra
  </a>
  
</div>

</section>
<div id="footer"></div>

<script>
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
const lista = document.getElementById("lista-carrito");
const totalSpan = document.getElementById("total");

function guardarCarrito() {
  localStorage.setItem("carrito", JSON.stringify(carrito));
}

function renderCarrito() {
  lista.innerHTML = "";
  let total = 0;

  if (carrito.length === 0) {
    lista.innerHTML = "<p>El carrito está vacío.</p>";
    totalSpan.textContent = "0";
    return;
  }

  carrito.forEach((prod, index) => {
    const subtotal = prod.precio * prod.cantidad;
    total += subtotal;

    lista.innerHTML += `
      <div class="row align-items-center border-bottom py-3">
        <div class="col-md-2">
          <img src="${prod.imagen}" class="producto-img">
        </div>

        <div class="col-md-3">
          <h6>${prod.nombre}</h6>
        </div>

        <div class="col-md-3 d-flex align-items-center gap-2">
          <button class="cantidad-btn" onclick="disminuir(${index})">−</button>
          <span>${prod.cantidad}</span>
          <button class="cantidad-btn" onclick="aumentar(${index})">+</button>
        </div>

        <div class="col-md-2">
          $${subtotal.toLocaleString()}
        </div>

        <div class="col-md-2 text-end">
          <button onclick="eliminarProducto(${index})" class="btn btn-sm btn-danger">
            Eliminar
          </button>
        </div>
      </div>
    `;
  });

  totalSpan.textContent = total.toLocaleString();
}

function aumentar(index) {
  carrito[index].cantidad++;
  guardarCarrito();
  renderCarrito();
}

function disminuir(index) {
  if (carrito[index].cantidad > 1) {
    carrito[index].cantidad--;
  } else {
    carrito.splice(index, 1);
  }
  guardarCarrito();
  renderCarrito();
}

function eliminarProducto(index) {
  carrito.splice(index, 1);
  guardarCarrito();
  renderCarrito();
}

function vaciarCarrito() {
  carrito = [];
  localStorage.removeItem("carrito");
  renderCarrito();
}

renderCarrito();
</script>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script src="js/firebase.js"></script>

<script src="./js/navbar.js"></script>
<script src="./js/footer.js"></script>
<script src="./js/app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>
