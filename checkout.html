<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Checkout</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

</head>

<body class="container my-5">

<div id="navbar-container"></div>


<div class="row">

  <!-- FORMULARIO -->
  <div class="col-md-6">
    <form id="form-checkout">
      <input class="form-control mb-3" id="nombre" placeholder="Nombre y Apellido" required>
      <input class="form-control mb-3" id="direccion" placeholder="Domicilio" required>
      <input class="form-control mb-3" id="localidad" placeholder="Localidad" required>
      <input class="form-control mb-3" id="telefono" placeholder="TelÃ©fono" required>
      <input type="email" class="form-control mb-3" id="email" placeholder="Email" required>

      <button type="submit" class="btn btn-dark w-100">
        Confirmar Pedido
      </button>
    </form>
  </div>

  <!-- RESUMEN -->
  <div class="col-md-6">
    <h5>Resumen del Pedido</h5>
    <div id="resumen-carrito" class="border p-3"></div>
    <h5 class="mt-3 text-end">
      Total: $<span id="total">0</span>
    </h5>
  </div>

</div>

<script>
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
const resumen = document.getElementById("resumen-carrito");
const totalSpan = document.getElementById("total");

function renderResumen() {
  resumen.innerHTML = "";
  let total = 0;

  if (carrito.length === 0) {
    resumen.innerHTML = "<p>No hay productos en el carrito.</p>";
    return;
  }

  carrito.forEach(prod => {
    const subtotal = prod.precio * prod.cantidad;
    total += subtotal;

    resumen.innerHTML += `
      <div class="d-flex justify-content-between border-bottom py-2">
        <div>
          <strong>${prod.nombre}</strong><br>
          Cantidad: ${prod.cantidad}
        </div>
        <div>
          $${subtotal.toLocaleString()}
        </div>
      </div>
    `;
  });

  totalSpan.textContent = total.toLocaleString();
}

document.getElementById("form-checkout").addEventListener("submit", function(e) {
  e.preventDefault();

  if (carrito.length === 0) {
    alert("El carrito estÃ¡ vacÃ­o.");
    return;
  }

  const orden = {
    cliente: {
      nombre: document.getElementById("nombre").value,
      direccion: document.getElementById("direccion").value,
      localidad: document.getElementById("localidad").value,
      telefono: document.getElementById("telefono").value,
      email: document.getElementById("email").value
    },
    productos: carrito,
    fecha: new Date().toLocaleString()
  };

  let ordenes = JSON.parse(localStorage.getItem("ordenes")) || [];
  ordenes.push(orden);
  localStorage.setItem("ordenes", JSON.stringify(ordenes));

  localStorage.removeItem("carrito");

  alert("Pedido confirmado correctamente ðŸŽ‰");

  window.location.href = "index.html";
});

renderResumen();
</script>
<script src="./js/navbar.js"></script>
<script src="./js/app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>
